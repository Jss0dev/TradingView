//@version=6
library("KarmaRSI", overlay=false)

// Exported log regression based on natural log and linear regression
export f_log_regression(float src, int len) =>
    float ln  = math.log(math.max(src, 1e-10))
    float y0  = ta.linreg(ln, len, 0)
    float y1  = ta.linreg(ln, len, 1)
    float a   = y0 - y1
    float b   = y0 - a * (len - 1)
    float s   = -a
    float c   = a * len + b
    [s, c]

// Exported RSI and signal calculation
export calc_rsi_signal(float src, int rsiLen, int signalLen) =>
    float rsi = ta.rsi(src, rsiLen)
    float sig = ta.sma(rsi, signalLen)
    [rsi, sig]
